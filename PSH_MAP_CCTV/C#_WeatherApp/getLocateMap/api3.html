<!DOCTYPE html>
<html>
<head>
	<meta charset=""utf-8"">
	<title>ì§€????ë²„íŠ¼?¼ë¡œ ë¡œë“œë·??œì‹œ?˜ê¸°</title>
	<style>
		#container {overflow:hidden;height:193px;position:relative;}
		#mapWrapper {width:100%;height:193px;z-index:1;}
		#rvWrapper {width:50%;height:193px;top:0;right:0;position:absolute;z-index:0;}
		#container.view_roadview #mapWrapper {width: 50%;}
		#roadviewControl {position:absolute;top:5px;left:5px;width:42px;height:42px;z-index: 1;cursor: pointer; background: url(https://t1.daumcdn.net/localimg/localimages/07/2018/pc/common/img_search.png) 0 -450px no-repeat;}
		#roadviewControl.active {background-position:0 -350px;}
		#close {position: absolute;padding: 4px;top: 5px;left: 5px;cursor: pointer;background: #fff;border-radius: 4px;border: 1px solid #c8c8c8;box-shadow: 0px 1px #888;}
		#close .img {display: block;background: url(https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/rv_close.png) no-repeat;width: 14px;height: 14px;}
	</style>
	</head>
		<script>
			window.kakao=window.kakao||{},window.kakao.maps=window.kakao.maps||{},window.daum&&window.daum.maps?window.kakao.maps=window.daum.maps:(window.daum=window.daum||{},window.daum.maps=window.kakao.maps),function(){function a(){if(E.length){t(I[E.shift()],a).start()}else e()}function t(a,t){var e=document.createElement(""script"");return e.charset=""utf-8"",e.onload=t,e.onreadystatechange=function(){/loaded|complete/.test(this.readyState)&&t()},{start:function(){e.src=a||"""",document.getElementsByTagName(""head"")[0].appendChild(e),e=null}}}function e(){for(;c[0];)c.shift()();o.readyState=2}var o=kakao.maps=kakao.maps||{};if(void 0===o.readyState)o.onloadcallbacks=[],o.readyState=0;else if(2===o.readyState)return;o.VERSION={ROADMAP:""2303ksn"",ROADMAP_SUFFIX:"""",HYBRID:""2303ksn"",SR:""3.00"",ROADVIEW:""7.00"",ROADVIEW_FLASH:""200402"",BICYCLE:""6.00"",USE_DISTRICT:""2303ksn"",SKYVIEW_VERSION:""160114"",SKYVIEW_HD_VERSION:""160107""},o.RESOURCE_PATH={ROADVIEW_AJAX:""//t1.daumcdn.net/roadviewjscore/core/css3d/200204/standard/1580795088957/roadview.js"",ROADVIEW_CSS:""//t1.daumcdn.net/roadviewjscore/core/openapi/standard/230112/roadview.js""};for(var n,r=""https:""==location.protocol?""https:"":""http:"",s="""",i=document.getElementsByTagName(""script""),d=i.length;n=i[--d];)if(/\/(beta-)?dapi\.kakao\.com\/v2\/maps\/sdk\.js\b/.test(n.src)){s=n.src;break}i=null;var c=o.onloadcallbacks,E=[""v3""],S="""",I={v3:r+""//t1.daumcdn.net/mapjsapi/js/main/4.4.8/kakao.js"",services:r+""//t1.daumcdn.net/mapjsapi/js/libs/services/1.0.2/services.js"",drawing:r+""//t1.daumcdn.net/mapjsapi/js/libs/drawing/1.2.6/drawing.js"",clusterer:r+""//t1.daumcdn.net/mapjsapi/js/libs/clusterer/1.0.9/clusterer.js""},_=function(a){var t={};return a.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(a,e,o){t[e]=o}),t}(s);S=_.appkey,S&&(o.apikey=S),o.version=""4.4.8"";var R=_.libraries;if(R&&(E=E.concat(R.split("",""))),""false""!==_.autoload){for(var d=0,l=E.length;d<l;d++)!function(a){a&&document.write('<script charset=""UTF-8"" src=""'+a+'""><\/script>')}(I[E[d]]);o.readyState=2}o.load=function(t){switch(c.push(t),o.readyState){case 0:o.readyState=1,a();break;case 2:e()}}}();
		</script>
	<body>
		<div id=""container"">
			<div id=""rvWrapper"">
				<div id=""roadview"" style=""width:100%;height:100%;""></div> <!-- ë¡œë“œë·°ë? ?œì‹œ??div ?…ë‹ˆ??-->
				<div id=""close"" title=""ë¡œë“œë·°ë‹«ê¸?" onclick=""closeRoadview()""><span class=""img""></span></div>
			</div>
			<div id=""mapWrapper"">
				<div id=""map"" style=""width:100%;height:100%""></div> <!-- ì§€?„ë? ?œì‹œ??div ?…ë‹ˆ??-->
				<div id=""roadviewControl"" onclick=""setRoadviewRoad()""></div>
			</div>
		</div>

	<script type=""text/javascript"" src=""//dapi.kakao.com/v2/maps/sdk.js?appkey=a71fd4e07d867d250dec31c7fa8e7742""></script>
	<script>
		var overlayOn = false, // ì§€???„ì— ë¡œë“œë·??¤ë²„?ˆì´ê°€ ì¶”ê????íƒœë¥?ê°€ì§€ê³??ˆì„ ë³€??
			container = document.getElementById('container'), // ì§€?„ì? ë¡œë“œë·°ë? ê°ì‹¸ê³??ˆëŠ” div ?…ë‹ˆ??
			mapWrapper = document.getElementById('mapWrapper'), // ì§€?„ë? ê°ì‹¸ê³??ˆëŠ” div ?…ë‹ˆ??
			mapContainer = document.getElementById('map'), // ì§€?„ë? ?œì‹œ??div ?…ë‹ˆ??
			rvContainer = document.getElementById('roadview'); //ë¡œë“œë·°ë? ?œì‹œ??div ?…ë‹ˆ??

		var mapCenter = new kakao.maps.LatLng(33.45042 , 126.57091), // ì§€?„ì˜ ì¤‘ì‹¬ì¢Œí‘œ
			mapOption = {
				center: mapCenter, // ì§€?„ì˜ ì¤‘ì‹¬ì¢Œí‘œ
				level: 3 // ì§€?„ì˜ ?•ë? ?ˆë²¨
			};

		// ì§€?„ë? ?œì‹œ??div?€ ì§€???µì…˜?¼ë¡œ ì§€?„ë? ?ì„±?©ë‹ˆ??
		var map = new kakao.maps.Map(mapContainer, mapOption);

		// ë¡œë“œë·?ê°ì²´ë¥??ì„±?©ë‹ˆ??
		var rv = new kakao.maps.Roadview(rvContainer); 

		// ì¢Œí‘œë¡œë???ë¡œë“œë·??Œë…¸?¼ë§ˆ IDë¥?ê°€?¸ì˜¬ ë¡œë“œë·??´ë¼?´ì–¸??ê°ì²´ë¥??ì„±?©ë‹ˆ??
		var rvClient = new kakao.maps.RoadviewClient(); 

		// ë¡œë“œë·°ì— ì¢Œí‘œê°€ ë°”ë€Œì—ˆ????ë°œìƒ?˜ëŠ” ?´ë²¤?¸ë? ?±ë¡?©ë‹ˆ??
		kakao.maps.event.addListener(rv, 'position_changed', function() {

			// ?„ì¬ ë¡œë“œë·°ì˜ ?„ì¹˜ ì¢Œí‘œë¥??»ì–´?µë‹ˆ??
			var rvPosition = rv.getPosition();

			// ì§€?„ì˜ ì¤‘ì‹¬???„ì¬ ë¡œë“œë·°ì˜ ?„ì¹˜ë¡??¤ì •?©ë‹ˆ??
			map.setCenter(rvPosition);

			// ì§€???„ì— ë¡œë“œë·??„ë¡œ ?¤ë²„?ˆì´ê°€ ì¶”ê????íƒœ?´ë©´
			if(overlayOn) {
				// ë§ˆì»¤???„ì¹˜ë¥??„ì¬ ë¡œë“œë·°ì˜ ?„ì¹˜ë¡??¤ì •?©ë‹ˆ??
				marker.setPosition(rvPosition);
			}
		});

		// ë§ˆì»¤ ?´ë?ì§€ë¥??ì„±?©ë‹ˆ??
		var markImage = new kakao.maps.MarkerImage(
			'https://t1.daumcdn.net/localimg/localimages/07/2018/pc/roadview_minimap_wk_2018.png',
			new kakao.maps.Size(26, 46),
			{
				// ?¤í”„?¼ì´???´ë?ì§€ë¥??¬ìš©?©ë‹ˆ??
				// ?¤í”„?¼ì´???´ë?ì§€ ?„ì²´???¬ê¸°ë¥?ì§€?•í•˜ê³?
				spriteSize: new kakao.maps.Size(1666, 168),
				// ?¬ìš©?˜ê³  ?¶ì? ?ì—­??ì¢Œìƒ??ì¢Œí‘œë¥??…ë ¥?©ë‹ˆ??
				// background-position?¼ë¡œ ì§€?•í•˜??ê°’ì´ë©?ë¶€?¸ëŠ” ë°˜ë??…ë‹ˆ??
				spriteOrigin: new kakao.maps.Point(705, 114),
				offset: new kakao.maps.Point(13, 46)
			}
		);

		// ?œë˜ê·¸ê? ê°€?¥í•œ ë§ˆì»¤ë¥??ì„±?©ë‹ˆ??
		var marker = new kakao.maps.Marker({
			image : markImage,
			position: mapCenter,
			draggable: true
		});

		// ë§ˆì»¤??dragend ?´ë²¤?¸ë? ?±ë¡?©ë‹ˆ??
		kakao.maps.event.addListener(marker, 'dragend', function(mouseEvent) {

			// ?„ì¬ ë§ˆì»¤ê°€ ?“ì¸ ?ë¦¬??ì¢Œí‘œ?…ë‹ˆ??
			var position = marker.getPosition();

			// ë§ˆì»¤ê°€ ?“ì¸ ?„ì¹˜ë¥?ê¸°ì??¼ë¡œ ë¡œë“œë·°ë? ?¤ì •?©ë‹ˆ??
			toggleRoadview(position);
		});

		//ì§€?„ì— ?´ë¦­ ?´ë²¤?¸ë? ?±ë¡?©ë‹ˆ??
		kakao.maps.event.addListener(map, 'click', function(mouseEvent){

			// ì§€???„ì— ë¡œë“œë·??„ë¡œ ?¤ë²„?ˆì´ê°€ ì¶”ê????íƒœê°€ ?„ë‹ˆë©??´ë¦­?´ë²¤?¸ë? ë¬´ì‹œ?©ë‹ˆ??
			if(!overlayOn) {
				return;
			}

			// ?´ë¦­???„ì¹˜??ì¢Œí‘œ?…ë‹ˆ??
			var position = mouseEvent.latLng;

			// ë§ˆì»¤ë¥??´ë¦­???„ì¹˜ë¡???¹?ˆë‹¤
			marker.setPosition(position);

			// ?´ë½???„ì¹˜ë¥?ê¸°ì??¼ë¡œ ë¡œë“œë·°ë? ?¤ì •?©ë‹ˆ??
			toggleRoadview(position);
		});

		// ?„ë‹¬ë°›ì? ì¢Œí‘œ(position)??ê°€ê¹Œìš´ ë¡œë“œë·°ì˜ ?Œë…¸?¼ë§ˆ IDë¥?ì¶”ì¶œ?˜ì—¬
		// ë¡œë“œë·°ë? ?¤ì •?˜ëŠ” ?¨ìˆ˜?…ë‹ˆ??
		function toggleRoadview(position){
			rvClient.getNearestPanoId(position, 50, function(panoId) {
				// ?Œë…¸?¼ë§ˆ IDê°€ null ?´ë©´ ë¡œë“œë·°ë? ?¨ê¹?ˆë‹¤
				if (panoId === null) {
					toggleMapWrapper(true, position);
				} else {
				 toggleMapWrapper(false, position);

					// panoIdë¡?ë¡œë“œë·°ë? ?¤ì •?©ë‹ˆ??
					rv.setPanoId(panoId, position);
				}
			});
		}

		// ì§€?„ë? ê°ì‹¸ê³??ˆëŠ” div???¬ê¸°ë¥?ì¡°ì •?˜ëŠ” ?¨ìˆ˜?…ë‹ˆ??
		function toggleMapWrapper(active, position) {
			if (active) {

				// ì§€?„ë? ê°ì‹¸ê³??ˆëŠ” div???ˆë¹„ê°€ 100%ê°€ ?˜ë„ë¡?classë¥?ë³€ê²½í•©?ˆë‹¤ 
				container.className = '';

				// ì§€?„ì˜ ?¬ê¸°ê°€ ë³€ê²½ë˜?ˆê¸° ?Œë¬¸??relayout ?¨ìˆ˜ë¥??¸ì¶œ?©ë‹ˆ??
				map.relayout();

				// ì§€?„ì˜ ?ˆë¹„ê°€ ë³€ê²½ë  ??ì§€?„ì¤‘?¬ì„ ?…ë ¥ë°›ì? ?„ì¹˜(position)ë¡??¤ì •?©ë‹ˆ??
				map.setCenter(position);
			} else {

				// ì§€?„ë§Œ ë³´ì—¬ì§€ê³??ˆëŠ” ?íƒœ?´ë©´ ì§€?„ì˜ ?ˆë¹„ê°€ 50%ê°€ ?˜ë„ë¡?classë¥?ë³€ê²½í•˜??
				// ë¡œë“œë·°ê? ?¨ê»˜ ?œì‹œ?˜ê²Œ ?©ë‹ˆ??
				if (container.className.indexOf('view_roadview') === -1) {
					container.className = 'view_roadview';

					// ì§€?„ì˜ ?¬ê¸°ê°€ ë³€ê²½ë˜?ˆê¸° ?Œë¬¸??relayout ?¨ìˆ˜ë¥??¸ì¶œ?©ë‹ˆ??
					map.relayout();

					// ì§€?„ì˜ ?ˆë¹„ê°€ ë³€ê²½ë  ??ì§€?„ì¤‘?¬ì„ ?…ë ¥ë°›ì? ?„ì¹˜(position)ë¡??¤ì •?©ë‹ˆ??
					map.setCenter(position);
				}
			}
		}

		// ì§€???„ì˜ ë¡œë“œë·??„ë¡œ ?¤ë²„?ˆì´ë¥?ì¶”ê?,?œê±°?˜ëŠ” ?¨ìˆ˜?…ë‹ˆ??
		function toggleOverlay(active) {
			if (active) {
				overlayOn = true;

				// ì§€???„ì— ë¡œë“œë·??„ë¡œ ?¤ë²„?ˆì´ë¥?ì¶”ê??©ë‹ˆ??
				map.addOverlayMapTypeId(kakao.maps.MapTypeId.ROADVIEW);

				// ì§€???„ì— ë§ˆì»¤ë¥??œì‹œ?©ë‹ˆ??
				marker.setMap(map);

				// ë§ˆì»¤???„ì¹˜ë¥?ì§€??ì¤‘ì‹¬?¼ë¡œ ?¤ì •?©ë‹ˆ??
				marker.setPosition(map.getCenter());

				// ë¡œë“œë·°ì˜ ?„ì¹˜ë¥?ì§€??ì¤‘ì‹¬?¼ë¡œ ?¤ì •?©ë‹ˆ??
				toggleRoadview(map.getCenter());
			} else {
				overlayOn = false;

				// ì§€???„ì˜ ë¡œë“œë·??„ë¡œ ?¤ë²„?ˆì´ë¥??œê±°?©ë‹ˆ??
				map.removeOverlayMapTypeId(kakao.maps.MapTypeId.ROADVIEW);

				// ì§€???„ì˜ ë§ˆì»¤ë¥??œê±°?©ë‹ˆ??
				marker.setMap(null);
			}
		}

		// ì§€???„ì˜ ë¡œë“œë·?ë²„íŠ¼???Œë??????¸ì¶œ?˜ëŠ” ?¨ìˆ˜?…ë‹ˆ??
		function setRoadviewRoad() {
			var control = document.getElementById('roadviewControl');

			// ë²„íŠ¼???Œë¦° ?íƒœê°€ ?„ë‹ˆë©?
			if (control.className.indexOf('active') === -1) {
				control.className = 'active';

				// ë¡œë“œë·??„ë¡œ ?¤ë²„?ˆì´ê°€ ë³´ì´ê²??©ë‹ˆ??
				toggleOverlay(true);
			} else {
				control.className = '';

				// ë¡œë“œë·??„ë¡œ ?¤ë²„?ˆì´ë¥??œê±°?©ë‹ˆ??
				toggleOverlay(false);
			}
		}

		// ë¡œë“œë·°ì—??Xë²„íŠ¼???Œë?????ë¡œë“œë·°ë? ì§€???¤ë¡œ ?¨ê¸°???¨ìˆ˜?…ë‹ˆ??
		function closeRoadview() {
			var position = marker.getPosition();
			toggleMapWrapper(true, position);
		}
		</script>
	</body>
</html>